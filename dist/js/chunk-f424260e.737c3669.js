(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f424260e"],{"61bc":function(t,e,c){"use strict";c.r(e);c("a4d3"),c("e01a");var o=c("7a23"),l={class:"container py-4"},a={class:"d-flex justify-content-between"},n=Object(o["h"])("h1",{class:""},"商品列表",-1),i={class:"d-flex align-items-center"},r={class:"table mt-4 border-top table-hover"},d=Object(o["h"])("thead",null,[Object(o["h"])("tr",null,[Object(o["h"])("th",{width:"45%"},"產品"),Object(o["h"])("th",{width:"10%"},"類別"),Object(o["h"])("th",{width:"10%"},"原價"),Object(o["h"])("th",{width:"10%"},"售價"),Object(o["h"])("th",{width:"10%"},"啟用"),Object(o["h"])("th",{width:"15%"},"編輯/刪除")])],-1),s={class:"d-flex align-items-center"},u={class:"d-flex flex-column"},b={class:"align-middle"},p={class:"align-middle"},h={class:"align-middle"},m={class:"align-middle"},j={key:0,class:"text-success"},O={key:1},f={class:"align-middle"},v=Object(o["h"])("span",{class:"material-icons"},"edit",-1),g=Object(o["h"])("span",{class:"material-icons"},"delete",-1),P={class:"d-flex justify-content-between"},y={class:"text-gray"};function w(t,e,c,w,k,M){var x=Object(o["A"])("PulseLoader"),U=Object(o["A"])("pagination"),$=Object(o["A"])("product-modal"),C=Object(o["A"])("delProduct-modal");return Object(o["v"])(),Object(o["d"])("div",l,[Object(o["h"])(x,{loading:k.loading,color:k.color},null,8,["loading","color"]),Object(o["h"])("div",a,[n,Object(o["h"])("div",i,[Object(o["h"])("button",{type:"button",class:"btn btn-secondary text-white me-2",onClick:e[1]||(e[1]=function(t){return M.openModal("new")})}," 新增商品 ")])]),Object(o["h"])("table",r,[d,Object(o["h"])("tbody",null,[(Object(o["v"])(!0),Object(o["d"])(o["a"],null,Object(o["z"])(k.products,(function(e){return Object(o["v"])(),Object(o["d"])("tr",{key:e.id},[Object(o["h"])("td",s,[Object(o["h"])("img",{class:"align-middle me-3",src:e.imageUrl,alt:e.title,style:{width:"150px",height:"150px"}},null,8,["src","alt"]),Object(o["h"])("div",u,[Object(o["h"])("h4",null,Object(o["D"])(e.title),1),Object(o["h"])("span",null,Object(o["D"])(e.description),1)])]),Object(o["h"])("td",b,Object(o["D"])(e.category),1),Object(o["h"])("td",p,Object(o["D"])(t.$toCurrency(e.origin_price)),1),Object(o["h"])("td",h,Object(o["D"])(t.$toCurrency(e.price)),1),Object(o["h"])("td",m,[e.is_enabled?(Object(o["v"])(),Object(o["d"])("span",j,"啟用")):(Object(o["v"])(),Object(o["d"])("span",O,"未啟用"))]),Object(o["h"])("td",f,[Object(o["h"])("a",{href:"#",class:"editBtn me-2",onClick:Object(o["N"])((function(t){return M.openModal("edit",e)}),["prevent"])},[v],8,["onClick"]),Object(o["h"])("a",{href:"#",class:"deleteBtn",onClick:Object(o["N"])((function(t){return M.openModal("delete",e)}),["prevent"])},[g],8,["onClick"])])])})),128))])]),Object(o["h"])("div",P,[Object(o["h"])("p",y,"商品總共有"+Object(o["D"])(k.products.length)+"項",1),Object(o["h"])(U,{page:k.pagination,onGetProduct:M.getProductList},null,8,["page","onGetProduct"])]),Object(o["h"])($,{ref:"productModal",product:k.tempProduct,"is-new":k.isNew,onUpdateProduct:M.updateProduct},null,8,["product","is-new","onUpdateProduct"]),Object(o["h"])(C,{ref:"delProductModal","delete-item":k.tempProduct,onDelete:M.getProductList},null,8,["delete-item","onDelete"])])}var k=c("5530"),M=(c("99af"),c("ac1f"),c("5319"),c("8405")),x=(c("a434"),{class:"modal fade",id:"productModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"}),U={class:"modal-dialog modal-xl",role:"document"},$={class:"modal-content border-0"},C={class:"modal-header bg-dark text-white"},D={class:"modal-title",id:"exampleModalLabel"},V=Object(o["h"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),L={class:"modal-body"},H={class:"row"},N={class:"col-sm-4"},_={class:"mb-3"},z=Object(o["h"])("label",{for:"image",class:"form-label"},"輸入圖片網址",-1),B={class:"mb-3"},I=Object(o["h"])("label",{for:"customFile",class:"form-label"}," 或 上傳圖片 ",-1),S={class:"mb-3"},A={class:"col-sm-8"},F={class:"mb-3"},G=Object(o["h"])("label",{for:"title",class:"form-label"},"標題",-1),T={class:"row gx-2"},E={class:"mb-3 col-md-6"},J=Object(o["h"])("label",{for:"category",class:"form-label"},"分類",-1),Y={class:"mb-3 col-md-6"},q=Object(o["h"])("label",{for:"unit",class:"form-label"},"單位",-1),K={class:"row gx-2"},Q={class:"mb-3 col-md-6"},R=Object(o["h"])("label",{for:"origin_price",class:"form-label"},"原價",-1),W={class:"mb-3 col-md-6"},X=Object(o["h"])("label",{for:"price",class:"form-label"},"售價",-1),Z=Object(o["h"])("label",{class:"form-label"},"尺寸",-1),tt={class:"mb-3"},et=Object(o["h"])("hr",null,null,-1),ct={class:"mb-3"},ot=Object(o["h"])("label",{for:"description",class:"form-label"},"產品描述",-1),lt={class:"mb-3"},at=Object(o["h"])("label",{for:"content",class:"form-label"},"說明內容",-1),nt={class:"mb-3"},it={class:"form-check"},rt=Object(o["h"])("label",{class:"form-check-label",for:"is_enabled"}," 是否啟用 ",-1),dt={class:"modal-footer"},st=Object(o["h"])("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function ut(t,e,c,l,a,n){return Object(o["v"])(),Object(o["d"])("div",x,[Object(o["h"])("div",U,[Object(o["h"])("div",$,[Object(o["h"])("div",C,[Object(o["h"])("h5",D,[Object(o["h"])("span",null,Object(o["D"])(c.isNew?"新增產品":"編輯產品"),1)]),V]),Object(o["h"])("div",L,[Object(o["h"])("div",H,[Object(o["h"])("div",N,[Object(o["h"])("div",_,[z,Object(o["M"])(Object(o["h"])("input",{type:"text",class:"form-control",id:"image","onUpdate:modelValue":e[1]||(e[1]=function(t){return a.tempProduct.imageUrl=t}),placeholder:"請輸入圖片連結"},null,512),[[o["H"],a.tempProduct.imageUrl]])]),Object(o["h"])("div",B,[I,Object(o["h"])("input",{type:"file",id:"customFile",class:"form-control",ref:"fileInput",onChange:e[2]||(e[2]=function(){return n.uploadFile&&n.uploadFile.apply(n,arguments)})},null,544)]),Object(o["h"])("img",{class:"img-fluid",src:a.tempProduct.imageUrl},null,8,["src"]),a.tempProduct.imagesUrl?(Object(o["v"])(),Object(o["d"])(o["a"],{key:0},[(Object(o["v"])(!0),Object(o["d"])(o["a"],null,Object(o["z"])(a.tempProduct.imagesUrl,(function(t,e){return Object(o["v"])(),Object(o["d"])("div",{class:"mb-3",key:e},[Object(o["M"])(Object(o["h"])("input",{type:"url",class:"form-control","onUpdate:modelValue":function(t){return a.tempProduct.imagesUrl[e]=t},placeholder:"請輸入連結"},null,8,["onUpdate:modelValue"]),[[o["H"],a.tempProduct.imagesUrl[e]]]),Object(o["h"])("div",S,[Object(o["h"])("img",{class:"img-fluid",src:t},null,8,["src"])]),Object(o["h"])("button",{type:"button",class:"btn btn-outline-danger",onClick:function(t){return a.tempProduct.imagesUrl.splice(e,1)}}," 移除 ",8,["onClick"])])})),128)),a.tempProduct.imagesUrl[a.tempProduct.imagesUrl.length-1]||!a.tempProduct.imagesUrl.length?(Object(o["v"])(),Object(o["d"])("button",{key:0,type:"button",class:"btn btn-outline-primary btn-sm d-block w-100",onClick:e[3]||(e[3]=function(t){return a.tempProduct.imagesUrl.push("")})}," 新增圖片 ")):Object(o["e"])("",!0)],64)):Object(o["e"])("",!0)]),Object(o["h"])("div",A,[Object(o["h"])("div",F,[G,Object(o["M"])(Object(o["h"])("input",{type:"text",class:"form-control",id:"title","onUpdate:modelValue":e[4]||(e[4]=function(t){return a.tempProduct.title=t}),placeholder:"請輸入標題"},null,512),[[o["H"],a.tempProduct.title]])]),Object(o["h"])("div",T,[Object(o["h"])("div",E,[J,Object(o["M"])(Object(o["h"])("input",{type:"text",class:"form-control",id:"category","onUpdate:modelValue":e[5]||(e[5]=function(t){return a.tempProduct.category=t}),placeholder:"請輸入分類"},null,512),[[o["H"],a.tempProduct.category]])]),Object(o["h"])("div",Y,[q,Object(o["M"])(Object(o["h"])("input",{type:"text",class:"form-control",id:"unit","onUpdate:modelValue":e[6]||(e[6]=function(t){return a.tempProduct.unit=t}),placeholder:"請輸入單位"},null,512),[[o["H"],a.tempProduct.unit]])])]),Object(o["h"])("div",K,[Object(o["h"])("div",Q,[R,Object(o["M"])(Object(o["h"])("input",{type:"number",class:"form-control",id:"origin_price",min:"0","onUpdate:modelValue":e[7]||(e[7]=function(t){return a.tempProduct.origin_price=t}),placeholder:"請輸入原價"},null,512),[[o["H"],a.tempProduct.origin_price,void 0,{number:!0}]])]),Object(o["h"])("div",W,[X,Object(o["M"])(Object(o["h"])("input",{type:"number",class:"form-control",id:"price",min:"0","onUpdate:modelValue":e[8]||(e[8]=function(t){return a.tempProduct.price=t}),placeholder:"請輸入售價"},null,512),[[o["H"],a.tempProduct.price,void 0,{number:!0}]])])]),a.tempProduct.variable?(Object(o["v"])(),Object(o["d"])(o["a"],{key:0},[Z,(Object(o["v"])(!0),Object(o["d"])(o["a"],null,Object(o["z"])(a.tempProduct.variable,(function(t,e){return Object(o["v"])(),Object(o["d"])("div",{class:"mb-3",key:e},[Object(o["M"])(Object(o["h"])("input",{type:"text",class:"form-control mb-3","onUpdate:modelValue":function(t){return a.tempProduct.variable[e].size=t},placeholder:"請輸入尺寸"},null,8,["onUpdate:modelValue"]),[[o["H"],a.tempProduct.variable[e].size]]),Object(o["h"])("div",tt,[Object(o["h"])("button",{type:"button",class:"btn btn-outline-secondary",id:t.id},Object(o["D"])(t.size),9,["id"])]),Object(o["h"])("button",{type:"button",class:"btn btn-outline-danger",onClick:function(t){return a.tempProduct.variable.splice(e,1)}}," 移除 ",8,["onClick"])])})),128)),a.tempProduct.variable[a.tempProduct.variable.length-1]||!a.tempProduct.variable.length?(Object(o["v"])(),Object(o["d"])("button",{key:0,type:"button",class:"btn btn-outline-primary btn-sm d-block w-100",onClick:e[9]||(e[9]=function(t){return a.tempProduct.variable.push({})})}," 新增尺寸 ")):Object(o["e"])("",!0)],64)):Object(o["e"])("",!0),et,Object(o["h"])("div",ct,[ot,Object(o["M"])(Object(o["h"])("textarea",{type:"text",class:"form-control",id:"description","onUpdate:modelValue":e[10]||(e[10]=function(t){return a.tempProduct.description=t}),placeholder:"請輸入產品描述"},null,512),[[o["H"],a.tempProduct.description]])]),Object(o["h"])("div",lt,[at,Object(o["M"])(Object(o["h"])("textarea",{type:"text",class:"form-control",id:"content","onUpdate:modelValue":e[11]||(e[11]=function(t){return a.tempProduct.content=t}),placeholder:"請輸入產品說明內容"},null,512),[[o["H"],a.tempProduct.content]])]),Object(o["h"])("div",nt,[Object(o["h"])("div",it,[Object(o["M"])(Object(o["h"])("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":e[12]||(e[12]=function(t){return a.tempProduct.is_enabled=t}),"true-value":1,"false-value":0,id:"is_enabled"},null,512),[[o["G"],a.tempProduct.is_enabled]]),rt])])])])]),Object(o["h"])("div",dt,[st,Object(o["h"])("button",{type:"button",class:"btn btn-primary",onClick:e[13]||(e[13]=function(e){return t.$emit("update-product",a.tempProduct)})}," 確認 ")])])])],512)}var bt=c("7c2b"),pt=c.n(bt),ht={props:{product:{type:Object,default:function(){return{}}},isNew:{type:Boolean,default:!1}},emits:["update-product"],data:function(){return{status:{},modal:"",tempProduct:{variable:[]},size:""}},watch:{product:function(){this.tempProduct=this.product,this.tempProduct.imagesUrl||(this.tempProduct.imagesUrl=[])}},methods:{uploadFile:function(){var t=this,e=this.$refs.fileInput.files[0],c=new FormData;c.append("file-to-upload",e);var o="".concat("https://vue3-course-api.hexschool.io","/api/").concat("maroon5","/admin/upload");this.status.fileUploading=!0,this.$http.post(o,c,{headers:{"Content-Type":"multipart/form-data"}}).then((function(e){t.status.fileUploading=!1,e.data.success?(t.tempProduct.imageUrl=e.data.imageUrl,t.$refs.fileInput.value=""):t.$refs.fileInput.value=""}))},openModal:function(){this.modal.show()},hideModal:function(){this.modal.hide()}},mounted:function(){this.modal=new pt.a(this.$refs.modal)}};ht.render=ut;var mt=ht,jt={id:"delProductModal",ref:"modal",class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"},Ot={class:"modal-dialog"},ft={class:"modal-content border-0"},vt=Object(o["h"])("div",{class:"modal-header bg-danger text-white"},[Object(o["h"])("h5",{id:"delProductModalLabel",class:"modal-title"},[Object(o["h"])("span",null,"刪除產品")]),Object(o["h"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),gt={class:"modal-body"},Pt=Object(o["g"])(" 是否刪除 "),yt={class:"text-danger"},wt=Object(o["g"])(" 商品(刪除後將無法恢復)。 "),kt={class:"modal-footer"},Mt=Object(o["h"])("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function xt(t,e,c,l,a,n){return Object(o["v"])(),Object(o["d"])("div",jt,[Object(o["h"])("div",Ot,[Object(o["h"])("div",ft,[vt,Object(o["h"])("div",gt,[Pt,Object(o["h"])("strong",yt,Object(o["D"])(c.deleteItem.title),1),wt]),Object(o["h"])("div",kt,[Mt,Object(o["h"])("button",{type:"button",class:"btn btn-danger",onClick:e[1]||(e[1]=function(){return n.delProduct&&n.delProduct.apply(n,arguments)})}," 確認刪除 ")])])])],512)}var Ut={props:{deleteItem:{type:Object,default:function(){return{}}}},emits:["delete"],data:function(){return{modal:""}},mounted:function(){this.modal=new pt.a(this.$refs.modal,{keyboard:!1,backdrop:"static"})},methods:{delProduct:function(){var t=this,e="".concat("https://vue3-course-api.hexschool.io","/api/").concat("maroon5","/admin/product/").concat(this.deleteItem.id);this.$http.delete(e).then((function(e){e.data.success&&(t.hideModal(),t.$emit("delete"))})).catch((function(){t.$swal.fire({position:"top",icon:"error",title:"無法刪除產品",showConfirmButton:!1,timer:1e3})}))},openModal:function(){this.modal.show()},hideModal:function(){this.modal.hide()}}};Ut.render=xt;var $t=Ut,Ct=c("191f"),Dt={name:"Products",data:function(){return{token:"",products:[],isNew:!1,tempProduct:{imagesUrl:[],variable:[]},pagination:{},loading:!1,color:"#9DBEC7"}},components:{pagination:M["a"],productModal:mt,delProductModal:$t,PulseLoader:Ct["a"]},methods:{getProductList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.loading=!0;var c="".concat("https://vue3-course-api.hexschool.io","/api/").concat("maroon5","/admin/products?page=").concat(e);this.$http.get(c).then((function(e){e.data.success&&(t.products=e.data.products,t.pagination=e.data.pagination,t.loading=!1)})).catch((function(){t.$swal.fire({position:"top",icon:"error",title:"商品列表取得失敗",showConfirmButton:!1,timer:1e3}),t.loading=!1}))},openModal:function(t,e){switch(t){case"new":this.isNew=!0,this.tempProduct={imagesUrl:[],variable:[]},this.$refs.productModal.openModal();break;case"edit":this.isNew=!1,this.tempProduct=Object(k["a"])({},e),this.$refs.productModal.openModal();break;case"delete":this.isNew=!1,this.tempProduct=Object(k["a"])({},e),this.$refs.delProductModal.openModal();break;default:break}},updateProduct:function(t){var e=this;this.tempProduct=t;var c="".concat("https://vue3-course-api.hexschool.io","/api/").concat("maroon5","/admin/product"),o="post";this.isNew||(c="".concat("https://vue3-course-api.hexschool.io","/api/").concat("maroon5","/admin/product/").concat(this.tempProduct.id),o="put"),this.$http[o](c,{data:this.tempProduct}).then((function(t){t.data.success&&(e.$refs.productModal.hideModal(),e.getProductList())})).catch((function(){e.$swal.fire({position:"top",icon:"error",title:"商品無法更新",showConfirmButton:!1,timer:1e3}),e.loading=!1}))}},mounted:function(){this.token=document.cookie.replace(/(?:(?:^|.*;\s*)YuToken\s*=\s*([^;]*).*$)|^.*$/,"$1"),""===this.token&&this.$router.push("/login"),this.$http.defaults.headers.common.Authorization=this.token},created:function(){this.getProductList()}};Dt.render=w;e["default"]=Dt},a434:function(t,e,c){"use strict";var o=c("23e7"),l=c("23cb"),a=c("a691"),n=c("50c4"),i=c("7b0b"),r=c("65f0"),d=c("8418"),s=c("1dde"),u=s("splice"),b=Math.max,p=Math.min,h=9007199254740991,m="Maximum allowed length exceeded";o({target:"Array",proto:!0,forced:!u},{splice:function(t,e){var c,o,s,u,j,O,f=i(this),v=n(f.length),g=l(t,v),P=arguments.length;if(0===P?c=o=0:1===P?(c=0,o=v-g):(c=P-2,o=p(b(a(e),0),v-g)),v+c-o>h)throw TypeError(m);for(s=r(f,o),u=0;u<o;u++)j=g+u,j in f&&d(s,u,f[j]);if(s.length=o,c<o){for(u=g;u<v-o;u++)j=u+o,O=u+c,j in f?f[O]=f[j]:delete f[O];for(u=v;u>v-o+c;u--)delete f[u-1]}else if(c>o)for(u=v-o;u>g;u--)j=u+o-1,O=u+c-1,j in f?f[O]=f[j]:delete f[O];for(u=0;u<c;u++)f[u+g]=arguments[u+2];return f.length=v-o+c,s}})},e01a:function(t,e,c){"use strict";var o=c("23e7"),l=c("83ab"),a=c("da84"),n=c("5135"),i=c("861d"),r=c("9bf2").f,d=c("e893"),s=a.Symbol;if(l&&"function"==typeof s&&(!("description"in s.prototype)||void 0!==s().description)){var u={},b=function(){var t=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),e=this instanceof b?new s(t):void 0===t?s():s(t);return""===t&&(u[e]=!0),e};d(b,s);var p=b.prototype=s.prototype;p.constructor=b;var h=p.toString,m="Symbol(test)"==String(s("test")),j=/^Symbol\((.*)\)[^)]+$/;r(p,"description",{configurable:!0,get:function(){var t=i(this)?this.valueOf():this,e=h.call(t);if(n(u,t))return"";var c=m?e.slice(7,-1):e.replace(j,"$1");return""===c?void 0:c}}),o({global:!0,forced:!0},{Symbol:b})}}}]);
//# sourceMappingURL=chunk-f424260e.737c3669.js.map